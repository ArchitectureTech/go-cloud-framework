<!-- 地址：http://www.fchee.com/tool/upload/ -->

<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>基于Layui的多图片多文件批量上传-ASP版</title>
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <link rel="stylesheet" href="/css/cui.css" />
    <link rel="stylesheet" href="/css/style.css" />
    
    <link rel="stylesheet" href="lib/css/xadmin.css">
    <link rel="stylesheet" href="lib/css/uploader.css"/>
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
	<!--以下CSS是批量图片-->
	<style type="text/css">
	.imgContainer{
		display: inline-block;
		float:left;
		width: 75px;
		height: 75px;
		margin-right: 5px;
		margin-bottom: 2px;
		border: 0px solid #666666;
		position: relative;
		box-sizing: border-box;
	}
	.imgContainer img{
		width: 100%;
		height: 100%;
		cursor: pointer;
	}
	.imgContainer p{
		position: absolute;
		bottom: -1px;
		left: 0;
		width: 100%;
		height: 24px;
		background: #000000;
		text-align: center;
		line-height: 24px;
		color: white;
		font-size: 14px;
		font-weight: bold;
		cursor: pointer;
		display: none;
		opacity:0.7;
		border-bottom-right-radius:5px;
		border-bottom-left-radius:5px;
	}
	.imgContainer:hover p{
		display: block;
	}
    </style>
</head>
<body>

<body>
  
<!--PC Navigation-->
<div id="hd">
    <div class="wp">
        <div class="logo"><a href="/"><img src="/images/logo.png" alt=""></a></div>
        <div id="nav">
            <ul>
                <li><a href="/" >首页</a></li>
                <li><a href="/about.html" >关于风掣</a></li>
                <li><a href="/service.html" >服务项目</a></li>
                <li><a href="/case/" >经典案例</a></li>
                <li><a href="/news/" >资讯动态</a></li>
                <li><a href="/contact.html" >联系我们</a></li>
            </ul>
        </div>
        <div class="tel"></div>
    </div>
</div>
<div class="c"></div>
<!--PC Navigation End-->

<!--Mobile Navigation-->
<div id="m-hd">
    <a href="/" class="m-logo"><img src="/images/logo.png" alt=""></a>
    <div class="m-trigger"></div>
    <ul class="m-nav">
        <li><a href="/" class="v1 ">首页 </a></li>
        <li><a href="/about.html" class="v1 ">关于风掣</a></li>
        <li><a href="/service.html" class="v1 ">服务项目</a></li>
        <li><a href="/case/" class="v1 ">经典案例</a></li>
        <li><a href="/news/" class="v1 ">资讯动态</a></li>
        <li><a href="/contact.html" class="v1 ">联系我们</a></li>
    </ul>
</div>
<div class="c"></div>	
<!--Mobile Navigation End-->

<!--页面主题-->
<div id="bd">
    <div class="wp">
        <div class="tit-i">
            <h3>基于Layui的多图片多文件批量上传-ASP版</h3>
        </div>
        <a href="/tool/"><span style="float:right; width:100px; height:36px; line-height:36px; background:#22a1ff; border:1px solid #22a1ff; border-radius:5px; text-align:center; color:#FFFFFF; font-size:14px;">返回功能列表</span></a>
        <div class="c"></div>
        
        
        <div class="x-body">
        <form class="layui-form" lay-filter="" name="example">
            <label>Layui 多图片多文件 批量上传</label>
               
            <!--单张图片上传-->
            <div class="layui-upload">
              <div class="layui-upload-list">
                <div class="uploader upload_photopic">
                <img class="layui-upload-img" id="img_photopic" src="images/photo_defalut.png" width="100" height="100">
                <input type="hidden" name="photopic" id="photopic" class="layui-input" value="images/photo_defalut.png">
                <p id="TishiText"></p>
                    <div class="js-upload-hover">
                        <div class="cover"></div>
                        <i class="delete-icon delete-photopic"></i>
                        <div class="btns">
                            <div class="cover"></div>
                            <div class="icons"><a href="images/photo_defalut.png" id="photopicurl" target="_blank"><span class="zoomin-icon"><i></i></span></a></div>
                        </div>
                    </div>
              </div>
              </div>
              <button type="button" class="layui-btn layui-btn-normal" id="btn_photopic">单上传图片</button>
            </div>   
            <!--单张图片上传 end-->
             
            <!--批量图片上传-->
             <div class="layui-upload-list" id="manypicslist"></div>
             <div style="clear:both"></div>
             <div class="layui-upload">
                 <button type="button" class="layui-btn" id="manypics">多图片上传</button>
             </div>         
            <!--批量图片上传 end-->
          
        </form>
        </div>
		
        <div class="c"></div>
	</div>
</div>
<div style="margin-top:100px;"></div>	
<!--底部文件-->
<div id="fd" style="padding-top: 0px; margin:0px auto">
    <div class="fd-copy">
        <div class="wp">
            <p align="center"><span>上海风掣网络科技有限公司&nbsp;版权所有&nbsp;&nbsp;&nbsp;&nbsp;Copyright&copy; 2006-2019</span></p>
        </div>
    </div>
</div>
<!--底部文件 End-->	

</body>
</html>



    
	<script type="text/javascript" src="lib/jquery.min.js"></script>
    <script type="text/javascript" src="lib/layui/layui.js"></script>
    <script>
    layui.use(['larry','upload', 'form'], function(){
        var $ = layui.jquery
        ,upload = layui.upload
      	,form = layui.form;
        //单图片上传
        var uploadInst = upload.render({
            elem: '#btn_photopic'
            ,url: 'uploadmore.asp?action=savepic'
            ,before: function(obj){
                //预读本地文件示例，不支持ie8
                obj.preview(function(index, file, result){
                    $('#img_photopic').attr('src', result); //图片链接（base64）
                });
            }
            ,done: function(res){
                //如果上传失败
                if(res.code > 0){
                    return layer.msg('上传失败');
                }
                //上传成功
                layer.msg(res.msg);
                document.getElementById("photopicurl").href = res.srcpath; 
                document.getElementById("photopic").value= res.srcpath;			
            }
            ,error: function(){
                //演示失败状态，并实现重传
                var demoText = $('#TishiText');
                demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                demoText.find('.demo-reload').on('click', function(){
                uploadInst.upload();
                });
            }
        });
		
		  //多图片上传
		  upload.render({
			elem: '#manypics'
           	,url: 'uploadmore.asp?action=savelistpic&fytpe=0&modeid=88888503'
			,multiple: true  //true 是多张 false 单张
			,before: function(obj){
			}
			,done: function(res){
			  //上传完毕
			  document.getElementById("manypicslist").innerHTML=res.msg;
			}
            ,error: function(){
                return layer.msg('系统错误');
            }
		  });
		
		
    });
    
	function removeImg(imgid){   //多图片删除
		$.ajax({
			url: 'uploadmore.asp?action=deleteimg&fytpe=0&modeid='+imgid,
			dataType:'text',
			type:'post',
			success:function (data) {
				//alert(data);
				layer.msg("删除成功");
				document.getElementById("manypicslist").innerHTML=data;
			}
		})
	}

	//单图片删除
    var $hover_wx = $('.upload_photopic .js-upload-hover');
    $('.upload_photopic').mouseover(function() {
        if(document.getElementById("photopic").value=="" || document.getElementById("photopic").value=="images/photo_defalut.png"){
            $hover_wx.hide();
        }else{
            $hover_wx.show();
        }
    }).mouseout(function() {
        $hover_wx.hide();
    });
    $(".delete-photopic").click(function() {
        document.getElementById("img_photopic").src= "images/photo_defalut.png";
        document.getElementById("photopic").value= "";
        $hover_wx.hide();
    });
    </script>

</body>
</html>